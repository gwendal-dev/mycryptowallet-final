{"ast":null,"code":"'use strict';\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar api = function api() {\n  var ccxt = require('ccxt');\n\n  var sum = 0;\n  var i = 0;\n\n  exports.handler = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              response = {\n                statusCode: 200,\n                headers: {\n                  \"Access-Control-Allow-Headers\": \"Content-Type\",\n                  \"Access-Control-Allow-Origin\": \"http://localhost:3000\",\n                  \"Access-Control-Allow-Methods\": \"OPTIONS,POST,GET\"\n                },\n                body: JSON.stringify('Hello from Lambda!')\n              };\n              return _context.abrupt(\"return\", response);\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n    var exchangeId, exchangeClass, exchange;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            exchangeId = 'binance', exchangeClass = ccxt[exchangeId], exchange = new exchangeClass({\n              'apiKey': 'ySuKhuOVLAC0WExO0UkaEXJzpDSWUYtNU0r69I8cCf25pZm5N7NHUUGMNaMfq92m',\n              'secret': 'cfkSnMUbzk2n7a3IvlpB2hlIMSLdVnbh8wsh14MDO8DHzcYBuQeDZEFCyB5CzRuY',\n              'timeout': 30000,\n              'enableRateLimit': true // required! https://github.com/ccxt/ccxt/wiki/Manual#rate-limit\n\n            });\n            _context2.t0 = Object;\n            _context2.next = 4;\n            return exchange.fetchBalance();\n\n          case 4:\n            _context2.t1 = _context2.sent.total;\n\n            _context2.t0.entries.call(_context2.t0, _context2.t1).forEach(function (item) {\n              if (item[1] > 0) {\n                var XMLHttpRequest = require(\"xmlhttprequest\").XMLHttpRequest;\n\n                var burl = \"https://api.binance.com\";\n                var query = '/api/v1/ticker/24hr';\n                query += \"?symbol=\".concat(item[0], \"USDT\");\n                var url = burl + query;\n                var ourRequest = new XMLHttpRequest();\n                ourRequest.setHeader(\"Access-Control-Allow-Origin\", \"localhost:3000\");\n                ourRequest.setHeader(\"Access-Control-Allow-Credentials\", \"true\");\n                ourRequest.setHeader(\"Access-Control-Allow-Methods\", \"GET,HEAD,OPTIONS,POST,PUT\");\n                ourRequest.setHeader(\"Access-Control-Allow-Headers\", \"Access-Control-Allow-Headers, Origin,Accept, X-Requested-With, Content-Type, Access-Control-Request-Method, Access-Control-Request-Headers\");\n                ourRequest.open('GET', url, true);\n\n                ourRequest.onload = function () {\n                  var obj = JSON.parse(ourRequest.responseText);\n\n                  if (item[0] != 'USDT') {\n                    console.log(\"---------------------------------------------------\");\n                    console.log(\"\".concat(item[0], \" : \").concat(item[1]));\n                    console.log(\"\".concat(item[0], \" price : \").concat(obj.lastPrice, \"$\"));\n                    console.log(\"Balance \".concat(item[0], \" : \").concat(obj.lastPrice * item[1], \"$\"));\n                    sum += obj.lastPrice * item[1];\n                  } else {\n                    console.log(\"---------------------------------------------------\");\n                    console.log(\"\".concat(item[0], \" : \").concat(item[1]));\n                    console.log(\"\".concat(item[0], \" price : 1$\"));\n                    console.log(\"Balance \".concat(item[0], \" : \").concat(item[1] * 1, \"$\"));\n                    sum += 1 * item[1];\n                  }\n\n                  console.log(\"Balance total usd : \".concat(sum, \"$\"));\n                };\n\n                ourRequest.send();\n              }\n            });\n\n          case 6:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }))();\n};\n\nexport { api };","map":{"version":3,"sources":["/Users/gwendal/Desktop/mycryptowallet-final/app/javascript/plugins/Api.js"],"names":["api","ccxt","require","sum","i","exports","handler","event","response","statusCode","headers","body","JSON","stringify","exchangeId","exchangeClass","exchange","Object","fetchBalance","total","entries","forEach","item","XMLHttpRequest","burl","query","url","ourRequest","setHeader","open","onload","obj","parse","responseText","console","log","lastPrice","send"],"mappings":"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","sourcesContent":["'use strict';\nconst api = () => {\nconst ccxt = require ('ccxt');\nlet sum = 0;\nlet i = 0;\nexports.handler = async (event) => {\n    const response = {\n        statusCode: 200,\n        headers: {\n            \"Access-Control-Allow-Headers\" : \"Content-Type\",\n            \"Access-Control-Allow-Origin\": \"http://localhost:3000\",\n            \"Access-Control-Allow-Methods\": \"OPTIONS,POST,GET\"\n        },\n        body: JSON.stringify('Hello from Lambda!'),\n    };\n    return response;\n};\n(async function () {\n    const exchangeId = 'binance'\n        , exchangeClass = ccxt[exchangeId]\n        , exchange = new exchangeClass ({\n            'apiKey': 'ySuKhuOVLAC0WExO0UkaEXJzpDSWUYtNU0r69I8cCf25pZm5N7NHUUGMNaMfq92m',\n            'secret': 'cfkSnMUbzk2n7a3IvlpB2hlIMSLdVnbh8wsh14MDO8DHzcYBuQeDZEFCyB5CzRuY',\n            'timeout': 30000,\n            'enableRateLimit': true, // required! https://github.com/ccxt/ccxt/wiki/Manual#rate-limit\n        })\n    Object.entries((await exchange.fetchBalance()).total).forEach(item => {\n      if (item[1] > 0) {\n        const XMLHttpRequest = require(\"xmlhttprequest\").XMLHttpRequest;\n\n        const burl = \"https://api.binance.com\";\n\n        let query = '/api/v1/ticker/24hr';\n\n        query += `?symbol=${item[0]}USDT`;\n\n        const url = burl + query;\n\n        const ourRequest = new XMLHttpRequest();\n        ourRequest.setHeader(\"Access-Control-Allow-Origin\", \"localhost:3000\");\n        ourRequest.setHeader(\"Access-Control-Allow-Credentials\", \"true\");\n        ourRequest.setHeader(\"Access-Control-Allow-Methods\", \"GET,HEAD,OPTIONS,POST,PUT\");\n        ourRequest.setHeader(\"Access-Control-Allow-Headers\", \"Access-Control-Allow-Headers, Origin,Accept, X-Requested-With, Content-Type, Access-Control-Request-Method, Access-Control-Request-Headers\");\n\n        ourRequest.open('GET',url,true);\n\n        ourRequest.onload = function(){\n            const obj = JSON.parse(ourRequest.responseText);\n            if (item[0] != 'USDT') {\n              console.log(\"---------------------------------------------------\");\n              console.log(`${item[0]} : ${item[1]}`);\n              console.log(`${item[0]} price : ${obj.lastPrice}$`);\n              console.log(`Balance ${item[0]} : ${obj.lastPrice * item[1]}$`);\n              sum += obj.lastPrice * item[1];\n            } else {\n              console.log(\"---------------------------------------------------\");\n              console.log(`${item[0]} : ${item[1]}`);\n              console.log(`${item[0]} price : 1$`);\n              console.log(`Balance ${item[0]} : ${item[1] * 1}$`);\n              sum += 1 * item[1];\n            }\n            console.log(`Balance total usd : ${sum}$`);\n        }\n        ourRequest.send();\n      }\n    });\n}) ();\n}\n\nexport {api}\n"]},"metadata":{},"sourceType":"module"}